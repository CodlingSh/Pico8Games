pico-8 cartridge // http://www.pico-8.com
version 23
__lua__

function _init()
    score1 = 0
    score2 = 0
    xdir = 0
    ydir = flr(rnd(3)) - 1
    speed = 1
    mode = 0

    if flr(rnd(2)) == 1 then 
        xdir = 1
    else
        xdir = -1
    end
    
    if mode == 0 then
       titleupdate()
    else
        game()
        serve()
    end
end

function titleupdate()
    if btn(4) then
        mode = 1
        game()
        serve()
    end
end

function titledraw()
    print('pong', 63, 63, 7)
end

function game()
    paddle1 = {
        x = 2,
        y = 57,
        update = function(self)
            if btn(2, 1) and self.y > 0 then
                self.y -= 2
            end
            if btn(3, 1) and self.y + 13 < 127 then
                self.y += 2
            end
        end,
        draw = function(self)
            rectfill(self.x, self.y, self.x + 1, self.y + 13, 7)
        end
        }
    
    paddle2 = {
        x = 125,
        y = 57,
        update = function(self)
            if btn(2, 0) and self.y > 0 then
                self.y -= 2
            end
            if btn(3, 0) and self.y + 13 < 127 then
                self.y += 2
            end
        end,
        draw = function(self)
            rectfill(self.x, self.y, self.x - 1, self.y + 13, 7)
        end
        }
end

function serve()    
    ball = {
        x = 63,
        y = 63,
        x2 = 65,
        y2 = 65,
        update = function(self)
            self.x += xdir 
            self.x2 += xdir   
            self.y += ydir 
            self.y2 += ydir 
            
            -- check to see if the ball has hit the top or bottom of the screen
            if self.y <= 0 then
                ydir = 1 
                sfx(0)
            elseif self. y >= 127 then
                ydir = -1 
                sfx(0)
            end
            
            --check to see if the ball has hit paddle1
            if self.x == paddle1.x + 2 and self.y2 >= paddle1.y and self.y <= paddle1.y + 14 then
                xdir = xdir - (xdir * 2) -- return the ball
                sfx(3)
                if self.y <= paddle1.y + 5 then
                    ydir = -1 
                end
                if self.y > paddle1.y + 5 and self.y2 < paddle1.y + 9 then
                    ydir = 0
                end
                if self.y2 >= paddle1.y + 9 then
                    ydir = 1
                end
            end
    
            --check to see if the ball has hit paddle2
            if self.x2 == paddle2.x and self.y2 >= paddle2.y and self.y <= paddle2.y + 14 then
                xdir = xdir - (xdir * 2) -- return the ball
                sfx(3)
                if self.y <= paddle2.y + 5 then
                    ydir = -1
                end
                if self.y > paddle2.y + 5 and self.y2 < paddle2.y + 9 then
                    ydir = 0
                end
                if self.y2 >= paddle2.y + 9 then
                    ydir = 1
                end
            end
    
            --check to see if a player has scored
            if self.x2 < -10 then
                score2 += 1
                xdir = 1
                ydir = flr(rnd(3)) - 1
                sfx(1)
                serve()
            end
            if self.x > 137 then
                score1 += 1
                xdir = -1
                ydir = flr(rnd(3)) - 1
                sfx(1)
                serve()
            end
        end,
        draw = function(self)
            rectfill(self.x, self.y, self.x2, self.y2, 7)
            print(score1 .. ' to ' .. score2, 63-(3.5*3), 2, 7)
        end
        }
end

function _update60()
    if mode == 0 then
        titleupdate()
    else
        paddle1:update()
        paddle2:update()
        ball:update()
    end
end

function _draw()
    cls(1)
    if mode == 0 then
        titledraw()
    else
        map(0,0)
        paddle1:draw()
        paddle2:draw()
        ball:draw()
    end
end
__gfx__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000001020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000001020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000001020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000001020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000001020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000001020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000001020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000001020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000001020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000001020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000001020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000001020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000001020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000001020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000001020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
000400000c0200f04013050190601d070000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000300001e0501e0501e0501e0501e0501e050000001405015050150501405013050130500d2000a0500a0500a0500b0500b0500b050000000000000000000000000000000000000000000000000000000000000
000500002e7502e7502e7502e7502f7002f700216001f6001e6001c6001a60018600176001460012600106000d6000a6000860005600026000060000600000000000000000000000000000000000000000000000
001b0000220502a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000c0500c0500c0500c050240000c0500c0500c050240000c0500c0500c050240000c0500c050240000c0500c0500c0500c050240000c050240000c050240000c0500c0500c050240000c0500c05000000
001000000c0500c0500c0500c050000000c0500c0500c0500c0500c050000000c0500c050000000c0500c0500c0500c050000000c050000000c050000000c050000000c0500c0500c050000000c0500c05000000
001000001a05018050180501a0500000018050180501f0501d050000001a05018050180501a0500000018050180501f0501d050000001a05018050180501a0500000018050180501f0501d050000001a05018050
__music__
00 05464344
01 05064344
00 05064344
00 05064344
02 05064344

